<!DOCTYPE HTML>
<html lang="zh" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ruxgo 手册</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">简介</a></li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Ruxgo 安装</a></li><li class="chapter-item expanded "><a href="guide/index.html"><strong aria-hidden="true">2.</strong> Ruxgo 指南</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="guide/why_ruxgo.html"><strong aria-hidden="true">2.1.</strong> ​为什么 Ruxgo</a></li><li class="chapter-item expanded "><a href="guide/ruxgo_features.html"><strong aria-hidden="true">2.2.</strong> Ruxgo 设计特性</a></li><li class="chapter-item expanded "><a href="guide/build_project.html"><strong aria-hidden="true">2.3.</strong> 构建一个项目</a></li><li class="chapter-item expanded "><a href="guide/toml_file.html"><strong aria-hidden="true">2.4.</strong> 配置 TOML</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="guide/builder_module.html"><strong aria-hidden="true">2.4.1.</strong> builder 模块</a></li><li class="chapter-item expanded "><a href="guide/target_module.html"><strong aria-hidden="true">2.4.2.</strong> target 模块</a></li><li class="chapter-item expanded "><a href="guide/os_module.html"><strong aria-hidden="true">2.4.3.</strong> os 模块</a></li></ol></li><li class="chapter-item expanded "><a href="guide/toml_example.html"><strong aria-hidden="true">2.5.</strong> TOML 文件示例</a></li></ol></li><li class="chapter-item expanded "><a href="commands/index.html"><strong aria-hidden="true">3.</strong> Ruxgo 命令</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="commands/general-commands.html"><strong aria-hidden="true">3.1.</strong> 通用命令</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="commands/ruxgo-init.html"><strong aria-hidden="true">3.1.1.</strong> ruxgo init</a></li><li class="chapter-item expanded "><a href="commands/ruxgo-pkg.html"><strong aria-hidden="true">3.1.2.</strong> ruxgo pkg</a></li><li class="chapter-item expanded "><a href="commands/ruxgo-help.html"><strong aria-hidden="true">3.1.3.</strong> ruxgo help</a></li></ol></li><li class="chapter-item expanded "><a href="commands/build-commands.html"><strong aria-hidden="true">3.2.</strong> 构建命令</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="commands/ruxgo-build.html"><strong aria-hidden="true">3.2.1.</strong> ruxgo -b</a></li><li class="chapter-item expanded "><a href="commands/ruxgo-run.html"><strong aria-hidden="true">3.2.2.</strong> ruxgo -r</a></li><li class="chapter-item expanded "><a href="commands/ruxgo-clean.html"><strong aria-hidden="true">3.2.3.</strong> ruxgo -c</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="run_apps.html"><strong aria-hidden="true">4.</strong> 运行不同的app</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Ruxgo 手册</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/syswonder/ruxgo" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="简介"><a class="header" href="#简介">简介</a></h1>
<p><a href="https://github.com/syswonder/ruxgo">Ruxgo</a> 是一个类似 Cargo 的构建工具，用于构建 C 和 C++ 应用程序。与传统的 Make 构建工具不同，Ruxgo 的构建过程仅依赖一个 Toml 文件，其摒弃了繁杂的语法和规则限制，使得编译过程回归到更为简洁的状态。如果你对 Makefile 感到疲倦，Ruxgo 绝对值得你尝试，它能让你的构建过程变得更加轻松和高效。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ruxgo-安装"><a class="header" href="#ruxgo-安装">Ruxgo 安装</a></h1>
<p>要安装<code>ruxgo</code>可执行文件，您首先需要安装 Rust 和 Cargo。按照<a href="https://www.rust-lang.org/tools/install">Rust安装页面</a>上的说明操作。Ruxgo 目前至少需要 Rust 1.74 版本。</p>
<p>一旦您安装了 Rust，就可以使用以下命令来构建和安装 Ruxgo:</p>
<pre><code class="language-sh">cargo install ruxgo
</code></pre>
<p>这将自动从<a href="https://crates.io/">crates.io</a>下载并构建 Ruxgo，并将其安装到 Cargo 的全局二进制目录（默认为<code>~/.cargo/bin/</code>）。</p>
<p>发布到 crates.io 的版本将稍微落后于 GitHub 上托管的版本。如果您需要最新版本，您可以自己构建 Ruxgo 的 git 版本：</p>
<pre><code class="language-sh">cargo install --git https://github.com/syswonder/ruxgo.git ruxgo
</code></pre>
<p><strong>注意:</strong></p>
<p>如果您在安装时遇到问题，可能需要安装一些构建依赖项，请参考 RuxOS 下的<a href="https://github.com/syswonder/ruxos?tab=readme-ov-file#install-build-dependencies">README.md</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ruxgo-指南"><a class="header" href="#ruxgo-指南">Ruxgo 指南</a></h1>
<p>本指南将为您提供有关如何使用 Ruxgo 开发 C/C++ 应用程序的所有信息。</p>
<ul>
<li>
<p><a href="guide/./why_ruxgo.html">为什么 Ruxgo</a></p>
</li>
<li>
<p><a href="guide/./ruxgo_features.html">Ruxgo 设计特性</a></p>
</li>
<li>
<p><a href="guide/./toml_file.html">TOML 文件说明</a></p>
</li>
<li>
<p><a href="guide/./toml_example.html">TOML 文件示例</a></p>
</li>
<li>
<p><a href="guide/./ruxgo_develop.html">Ruxgo 发展</a></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="为什么-ruxgo"><a class="header" href="#为什么-ruxgo">为什么 Ruxgo</a></h1>
<p>在深入探讨 Ruxgo 之前，有必要强调构建工具在任何软件开发项目中的重要性。构建工具不仅负责将源代码转换为可执行程序，还涉及依赖管理、自动化构建和测试、以及代码质量控制等关键环节。尤其对于 unikernel 操作系统，这些工具不仅需要支持标准的构建流程，还要适应 unikernel 的特殊要求，如高度的模块化、特定环境下的优化构建等。</p>
<p><a href="https://github.com/syswonder/ruxos">RuxOS</a> ，作为一个基于 Rust 语言开发的轻量级 unikernel 操作系统，面临着独特的挑战和需求。初期，RuxOS 采用了 Make 构建工具，依赖其灵活性和广泛的应用兼容性，成功地开发并移植了一些 C/C++ 应用程序。但随着项目的发展，Make 的一些局限性开始显现。例如:</p>
<ul>
<li>Makefile 的复杂性：随着新应用的不断移植，Makefile 的配置变得愈加繁琐，导致项目在维护和扩展方面面临挑战；</li>
<li>Rust 生态集成不足：虽然 Makefile 可以封装 Cargo 命令来构建 RuxOS，但这种集成不是天然的，需要手动管理。这导致了 Rust 语言和 <a href="https://origin.eqing.tech/">crates.io</a> 生态系统中的某些优势无法被充分利用；</li>
<li>构件化需求不匹配：RuxOS 遵循 unikernel 思想，旨在为单一应用生成可运行的二进制镜像。这要求构建工具能够提供组件管理、按需构建等高级功能，而 Make 在这方面存在限制。</li>
</ul>
<p>因此，RuxOS 需要一个更加专业和高效的构建工具——这就是 Ruxgo 的起源。Ruxgo 是一个纯 Rust 编写的构建工具，与 RuxOS 完美融合。与其他 unikernel 操作系统类似，如 Unikraft 使用 Kraft，IncludeOS 使用 Conan，RuxOS 使用 Ruxgo 不仅解决了 Make 在现代软件开发中的局限性，还完全利用了 Rust 语言及其生态系统的优势。</p>
<p>相较于原有的 Make 构建工具，Ruxgo 具有以下<strong>显著特点</strong>：</p>
<ul>
<li><strong>简化的配置文件</strong>：采用 <a href="https://github.com/toml-lang/toml">TOML</a> 作为配置文件的格式，提供了一个语法简单、易于理解和维护的配置环境。使得开发者可以专注于构建逻辑，而非配置文件的复杂性；</li>
<li><strong>利用 Rust 优势</strong>：Ruxgo 一方面利用 Rust 本身的诸多优势特性，如内存安全、并发处理等。另一方面深度利用 RuxOS 和 <a href="https://crates.io/">crates.io</a> 的生态系统，使得构建过程更加高效、流畅和稳定；</li>
<li><strong>组件化构建功能</strong>：针对 unikernel 和构件化操作系统的特点，Ruxgo 提供了模块化的构建方式以及包管理器，支持用户高效的按需编译和构件管理。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="设计特性"><a class="header" href="#设计特性">​设计特性</a></h1>
<p>Ruxgo 设计充分考虑构建过程的效率、可靠性和可维护性，同时充分适应 RuxOS 的构件化特性：</p>
<ul>
<li>
<p><strong>多样化的编译选项</strong>：Ruxgo 支持多种编译器（如 GCC、Clang、MSVC）和多样化的中间过程（如生成静态库、动态库、目标文件等），为最佳性能提供灵活选择。</p>
</li>
<li>
<p><strong>增量与并行构建</strong>：通过增量构建，Ruxgo 只编译修改过的文件或模块，大幅缩短构建时间。同时利用多核处理器同时编译多个文件，实现并行构建，进一步提高效率。</p>
</li>
<li>
<p><strong>简化的配置文件</strong>：完全使用 Toml 文件来描述构建参数，避免使用复杂的语法和依赖规则的构建流程。开发者只专注于构建逻辑，而非配置文件的复杂性</p>
</li>
<li>
<p><strong>依赖管理与可移植性</strong>：结合包管理功能和 crate.io 生态来简化外部库和组件的依赖管理。同时代码尽量使用平台无关的 API，增强跨平台兼容性。</p>
</li>
<li>
<p><strong>构建过程模块化</strong>：构建过程以 Target 为中心，按照不同的 Target 模块来配置源文件和依赖库。构建应用程序可以像搭积木一样进行。</p>
</li>
<li>
<p><strong>源码和构建目录分离</strong>：构建过程中生成的中间文件都会被放置在构建目录<code>ruxgo_bld/</code>中，防止构建过程中文件冲突和混乱。</p>
</li>
<li>
<p><strong>友好的编译错误诊断</strong>：使用更友好的编译器错误输出显示，包括清晰的错误提示、指向源代码行数等信息。</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="构建一个项目"><a class="header" href="#构建一个项目">构建一个项目</a></h1>
<p>首先，确保您的系统上已安装 ruxgo。如果尚未安装，请参考 <a href="guide/../installation.html">Ruxgo 安装</a> 。</p>
<p>之后使用如下命令初始化一个 C 项目：</p>
<pre><code class="language-bash">ruxgo init my_project --c
</code></pre>
<p>初始化完成后，切换到 my_project 目录，使用 ruxgo 构建并运行：</p>
<pre><code class="language-bash">ruxgo -b
ruxgo -r
</code></pre>
<p>如果您想在 RuxOS 上运行，将 my_project 下的<code>config_&lt;platform&gt;.toml</code>文件修改为如下:</p>
<pre><code class="language-toml">[build]
compiler = "gcc"

[os]
name = "ruxos"
services = []
ulib = "ruxlibc"

[os.platform]
name = "x86_64-qemu-q35"
mode = "release"
log = "info"

[os.platform.qemu]
graphic = "n"

[[targets]]
name = "main"
src = "./src/"
include_dir = "./src/include/"
type = "exe"
cflags = "-g -Wall -Wextra"
linker = "rust-lld -flavor gnu"
ldflags = ""
deps = []
</code></pre>
<p>之后将 my_project 复制到 ruxos/apps/c 目录下，切换到 my_project 目录，使用 ruxgo 构建并运行：</p>
<pre><code class="language-bash">ruxgo -b
ruxgo -r
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="toml-文件说明"><a class="header" href="#toml-文件说明">TOML 文件说明</a></h1>
<p>由于 C/C++ 项目需要处理复杂的项目配置，包括库依赖、编译选项、链接选项等，TOML 文件格式提供了一个清晰、结构化且易于理解的方式来组织这些信息。它使得开发者可以轻松地查看和编辑项目设置，同时确保这些设置的精确性和一致性。</p>
<p>Ruxgo 采用 <code>config_&lt;platform&gt;.toml</code> 文件来配置各个项目（<code>&lt;platform&gt;</code>根据运行平台的不同而变化，例如 <code>config_linux.toml</code> 或 <code>config_win32.toml</code>）。此外，由于 TOML 的跨平台和语言无关特性，ruxgo 可以更容易地集成到不同的环境和工作流中，提高了其适应性和可扩展性。</p>
<p><code>config_&lt;platform&gt;.toml</code> 文件由一个 <strong>[build]</strong> 模块和多个 <strong>[targets]</strong> 模块组成。如果你想在 RuxOS 上运行，可以添加 <strong>[os]</strong> 模块。</p>
<ul>
<li>
<p><a href="guide/./builder_module.html">builder 模块</a></p>
</li>
<li>
<p><a href="guide/./target_module.html">target 模块</a></p>
</li>
<li>
<p><a href="guide/./os_module.html">os 模块</a></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="builder-模块"><a class="header" href="#builder-模块">builder 模块</a></h1>
<p><strong>[build]</strong> 模块描述了编译器的类型。它包含 <code>compiler</code>。</p>
<ul>
<li><code>compiler</code>: 指定编译器类型，例如: “gcc”。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="target-模块"><a class="header" href="#target-模块">target 模块</a></h1>
<p><strong>[targets]</strong> 模块是 Toml 的核心部分，主要用于描述源代码的构建过程和库之间的依赖关系，如下所示:</p>
<ul>
<li>
<p><code>name</code>: 指定目标的名称，如果是 “dll” 类型，必须以 “lib_” 开头。</p>
</li>
<li>
<p><code>src</code>: 指定目标源代码的路径，会递归构建该目录下的所有源文件。</p>
</li>
<li>
<p><code>src_only</code>: 可选。如果你只想使用<code>src</code>中的某些源文件，可以在此处指定。</p>
</li>
<li>
<p><code>src_exclude</code>: 可选。如果你想要排除<code>src</code>中的某些源文件或目录，可以在此处指定。</p>
</li>
<li>
<p><code>include_dir</code>: 指定目标源代码的头文件路径，允许向量类型以支持多个头文件路径。</p>
</li>
<li>
<p><code>type</code>: 指定目标的类型，可以是 “static”、“dll”、“object” 或 “exe”。需要注意的是，在一个 Toml 文件中只能有一个 “exe” 目标，但可以有多个其他类型的目标。</p>
</li>
<li>
<p><code>cflags</code>: 指定目标的编译选项。</p>
</li>
<li>
<p><code>archive</code>: 可选。如果目标类型是 “static”，你可以指定一个归档工具来创建静态库。</p>
</li>
<li>
<p><code>linker</code>: 可选。指定用于链接动态库或其他目标文件的链接工具。如果该值缺失，则默认根据<code>compiler</code>指定。</p>
</li>
<li>
<p><code>ldflags</code>: 指定目标的链接选项。</p>
</li>
<li>
<p><code>deps</code>: 指定当前目标依赖的其他目标。</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="os-模块"><a class="header" href="#os-模块">os 模块</a></h1>
<p><strong>[os]</strong> 模块是可选的。如果你想在本地运行，[build] 和 [targets] 是完全满足，如果你想在 RuxOS 上运行，则需要添加[os] 模块。</p>
<p>添加 [os] 模块后，原有 [targets] 模块的一些内容将会发生改变。例如:</p>
<p>当 [os] 模块的平台是 “x86_64-qemu-q35” 时，编译器类型不再是 “gcc”，它将变成 “x86_64-linux-musl-gcc”。此外，所有 [targets] 的 cflags 都默认添加了 “-nostdinc -fno-builtin -ffreestanding -Wall”，当 [targets] 类型是 “exe” 时，ldflags 还默认添加了 “-nostdlib -static -no-pie –gc-sections”，你不需要去手动添加它们。当然，根据架构和平台的不同，还有其他默认的添加及改变。</p>
<p>Ruxgo 这么做是为了，如果你能在本地跑通一个程序，那么只需要将定制的 [os] 模块拼接到你本地跑通的模块上，即可实现在 RuxOS 上流畅的运行，而不需要额外的操作!</p>
<p>具体 <strong>[os]</strong> 模块描述如下:</p>
<ul>
<li>
<p><code>name</code>: 指定操作系统的名称。</p>
</li>
<li>
<p><code>services</code>: 指定操作系统可以提供的服务，类似于 RuxOS 中的 <code>features</code>。</p>
</li>
<li>
<p><code>ulib</code>: 指定想要使用的用户库，可选项有: “ruxlibc”，“ruxmusl”。</p>
</li>
<li>
<p><code>platform</code>: 如果需要，请在 [os.platform] 中进行配置。</p>
</li>
</ul>
<p>如果你想进一步配置平台，可以在 <strong>[os.platform]</strong> 中实现。如果为空，则使用默认值。具体细节如下:</p>
<ul>
<li>
<p><code>name</code>: 指定操作系统在哪个平台上运行，可选项有: “x86_64-qemu-q35”， “aarch64-qemu-virt”， “riscv64-qemu-virt”。默认值为 “x86_64-qemu-q35”。</p>
</li>
<li>
<p><code>smp</code>: 指定cpu数量。默认值为 “1”。</p>
</li>
<li>
<p><code>mode</code>: 指定构建模式，可选项有: “release”，当不指定 mode 模式时默认为 “debug”。</p>
</li>
<li>
<p><code>log</code>: 指定日志级别，可选项有: “warn”，“error”，“info”，“debug” 和 “trace”。默认值为 “warn”。</p>
</li>
<li>
<p><code>v</code>: 指定 verbose 级别，可选项有: “”，“1”，“2”。默认值为 “”。</p>
</li>
<li>
<p><code>qemu</code>: 如果需要，请在 [os.platform.qemu] 中进行配置。</p>
</li>
</ul>
<p>如果你的平台依赖于 qemu ，你需要在 <strong>[os.platform.qemu]</strong> 中进一步配置它。如果为空，则使用默认值。具体细节如下:</p>
<ul>
<li>
<p><code>blk</code>: 指定是否启用存储设备（virtio-blk）。默认值为 “n”。</p>
</li>
<li>
<p><code>net</code>: 指定是否启用网络设备（virtio-net）。默认值为 “n”。</p>
</li>
<li>
<p><code>graphic</code>: 指定是否启用显示设备和图形输出（virtio-gpu）。默认值为“n“。</p>
</li>
<li>
<p><code>debug</code>: 指定是否启用 gdb 服务，启用后监听本地 1234 端口。默认值为“n“。</p>
</li>
<li>
<p><code>disk_img</code>: 指定虚拟磁盘镜像的路径。默认值为 “./disk_img”。</p>
</li>
<li>
<p><code>v9p</code>: 指定是否启用 virtio-9p 设备。默认值为 “n”。</p>
</li>
<li>
<p><code>v9p_path</code>: 指定 virtio-9p 后端的主机路径。默认值为 “./”。</p>
</li>
<li>
<p><code>qemu_log</code>: 指定是否启用 QEMU 日志（日志文件为 “qemu.log” ）。默认值为 “n”。</p>
</li>
<li>
<p><code>net_dump</code>: 指定是否启用网络包转储（日志文件为 “netdump.pcap” ）。默认值为 “n”。</p>
</li>
<li>
<p><code>net_dev</code>: 指定 QEMU 网络设备后端类型: “user” 或 “tap”。默认值为 “user”。</p>
</li>
<li>
<p><code>ip</code>: 指定 IPv4 地址。QEMU “user” 网络设备的默认值为 “10.0.2.15”。</p>
</li>
<li>
<p><code>gw</code>: 指定 IPv4 地址的网关。QEMU “user” 网络设备的默认值为 “10.0.2.2”。</p>
</li>
<li>
<p><code>args</code>: 指定命令行参数，以逗号分隔。它用于传递特定的变量，如<code>argc</code>、<code>argv</code>。默认值为 “”。</p>
</li>
<li>
<p><code>envs</code>: 指定环境变量，键值对之间用逗号分隔。默认值为 “”。</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="toml-文件示例"><a class="header" href="#toml-文件示例">TOML 文件示例</a></h1>
<p>下面是 <a href="https://github.com/syswonder/ruxgo/tree/master/apps/sqlite3">sqlite3</a> 的 Toml 文件示例，具体运行可参考 <code>apps/sqlite3</code> 下的 README.md 。</p>
<p>带有库和可执行文件的示例文件（在本地运行）:</p>
<pre><code class="language-toml">[build]
compiler = "gcc"

[[targets]]
name = "libsqlite3"
src = "./sqlite-amalgamation-3410100"
src_exclude = ["shell.c"]
include_dir = "./sqlite-amalgamation-3410100"
type = "static"
cflags = "-w -DSQLITE_THREADSAFE=0 -DSQLITE_OMIT_FLOATING_POINT -DSQLITE_OMIT_LOAD_EXTENSION -DSQLITE_DEBUG"
archive = "ar"
ldflags = "rcs"

[[targets]]
name = "local_sqlite3"
src = "./"
src_exclude = ["sqlite-amalgamation-3410100"]
include_dir = "./"
type = "exe"
cflags = ""
ldflags = ""
deps = ["libsqlite3"]
</code></pre>
<p>带有库和可执行文件的示例文件（在ruxos上运行）:</p>
<pre><code class="language-toml">[build]
compiler = "gcc"

[os]
name = "ruxos"
services = ["fp_simd","alloc","paging","fs","blkfs"]
ulib = "ruxlibc"

[os.platform]
name = "x86_64-qemu-q35"
smp = "4"
mode = "release"
log = "error"

[os.platform.qemu]
blk = "y"
graphic = "n"

[[targets]]
name = "libsqlite3"
src = "./sqlite-amalgamation-3410100"
src_exclude = ["shell.c"]
include_dir = "./sqlite-amalgamation-3410100"
type = "static"
cflags = "-w -DSQLITE_THREADSAFE=0 -DSQLITE_OMIT_FLOATING_POINT -DSQLITE_OMIT_LOAD_EXTENSION -DSQLITE_DEBUG"
archive = "ar"
ldflags = "rcs"

[[targets]]
name = "ruxos_sqlite3"
src = "./"
src_exclude = ["sqlite-amalgamation-3410100"]
include_dir = "./"
type = "exe"
cflags = ""
linker = "rust-lld -flavor gnu"
ldflags = ""
deps = ["libsqlite3"]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ruxgo-命令"><a class="header" href="#ruxgo-命令">Ruxgo 命令</a></h1>
<ul>
<li>
<p><a href="commands/./general-commands.html">通用命令</a></p>
</li>
<li>
<p><a href="commands/./build-commands.html">构建命令</a></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="通用命令"><a class="header" href="#通用命令">通用命令</a></h1>
<ul>
<li>
<p><a href="commands/./ruxgo-init.html">ruxgo init</a></p>
</li>
<li>
<p><a href="commands/./ruxgo-pkg.html">ruxgo pkg</a></p>
</li>
<li>
<p><a href="commands/./ruxgo-help.html">ruxgo help</a></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ruxgo-init"><a class="header" href="#ruxgo-init">ruxgo init</a></h1>
<p>当您开始一个新项目时，通常需要一些基本的框架设置。<code>ruxgo</code> 提供了 <code>init</code> 命令来帮助您快速开始一个新的 C 或 C++ 项目。</p>
<h2 id="使用方式"><a class="header" href="#使用方式">使用方式</a></h2>
<p>要初始化一个新项目，使用以下命令：</p>
<pre><code>ruxgo init &lt;项目名称&gt; [--c] [--cpp]
</code></pre>
<ul>
<li><code>&lt;项目名称&gt;</code>: 指定新项目的名称。</li>
<li><code>--c</code>: 初始化一个 C 语言项目。</li>
<li><code>--cpp</code>: 初始化一个 C++ 语言项目。</li>
</ul>
<p>注意：<code>--c</code> 和 <code>--cpp</code> 选项不能同时使用。如果都不指定，则默认创建一个 C++ 项目。</p>
<h2 id="命令行为"><a class="header" href="#命令行为">命令行为</a></h2>
<p>当运行 <code>ruxgo init</code> 命令后，将会在当前目录下创建一个新的项目目录，其中包括以下内容：</p>
<pre><code>&lt;项目名称&gt;/
├── src/
│   ├── main.c 或 main.cpp
│   └── include/
├── .gitignore
├── README.md
├── LICENSE
└── config_&lt;platform&gt;.toml
</code></pre>
<ul>
<li><code>src/</code>：包含所有源代码文件和配置文件。</li>
<li><code>src/include</code>：用于存放头文件。</li>
<li><code>.gitignore</code>：用于指定 git 忽略的文件和目录。</li>
<li><code>README.md</code> 和 <code>LICENSE</code>：项目的基本文档。</li>
<li><code>config_&lt;platform&gt;.toml</code>：项目的配置文件，根据运行平台的不同而变化（例如 <code>config_linux.toml</code> 或 <code>config_win32.toml</code>）。</li>
</ul>
<h2 id="示例"><a class="header" href="#示例">示例</a></h2>
<ul>
<li>
<p>初始化一个名为 “my_project” 的 C++ 项目：</p>
<pre><code>ruxgo init my_project --cpp
</code></pre>
</li>
<li>
<p>初始化一个名为 “my_project” 的 C 项目：</p>
<pre><code>ruxgo init my_project --c
</code></pre>
</li>
</ul>
<h2 id="提示"><a class="header" href="#提示">提示</a></h2>
<ul>
<li>使用 <code>--help</code> 选项可以查看更多命令帮助。</li>
<li>当项目目录已经存在时，<code>ruxgo init</code> 将不会继续执行，并显示错误信息。</li>
<li>通过修改 <code>config_&lt;platform&gt;.toml</code> 文件，您可以自定义编译器选项和其他构建设置。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ruxgo-pkg"><a class="header" href="#ruxgo-pkg">ruxgo pkg</a></h1>
<p><code>ruxgo pkg</code> 命令用于管理软件包，包括列出、拉取、更新和清理软件包等。</p>
<h2 id="使用方式-1"><a class="header" href="#使用方式-1">使用方式</a></h2>
<p>要使用 <code>ruxgo pkg</code> 命令，您可以执行以下操作：</p>
<pre><code>ruxgo pkg [选项]
</code></pre>
<p>可选项如下：</p>
<ul>
<li><code>-l, --list</code>: 列出远程仓库中可用的软件包。</li>
<li><code>-p, --pull &lt;PKG_NAME&gt;</code>: 从远程仓库拉取特定软件包。</li>
<li><code>-r, --run &lt;APP_BIN&gt;</code>: 运行特定的应用程序二进制文件。</li>
<li><code>-u, --update &lt;PKG_NAME&gt;</code>: 更新特定软件包。</li>
<li><code>-c, --clean &lt;PKG_NAME&gt;</code>: 清理特定软件包。</li>
<li><code>--clean-all</code>: 清理所有软件包。</li>
<li><code>-h, --help</code>: 打印帮助信息。</li>
</ul>
<p>下载的文件保存在 <code>ruxgo_pkg/</code> 目录中，具体内容如下：</p>
<ul>
<li><code>app-bin/</code>: 存放 app 可执行文件及其对应脚本。</li>
<li><code>ruxos/</code>: ruxos 存储位置。</li>
<li><code>rux-*/</code>: app 源码存储位置。</li>
<li><code>cache/</code>: 存放 packages 信息的缓存。</li>
</ul>
<h2 id="示例-1"><a class="header" href="#示例-1">示例</a></h2>
<ul>
<li>
<p>列出所有可用的软件包：</p>
<pre><code>ruxgo pkg --list
</code></pre>
</li>
<li>
<p>从远程仓库拉取名为 “example_pkg” 的软件包：</p>
<pre><code>ruxgo pkg --pull example_pkg
</code></pre>
</li>
<li>
<p>更新名为 “example_pkg” 的软件包：</p>
<pre><code>ruxgo pkg --update example_pkg
</code></pre>
</li>
<li>
<p>清理名为 “example_pkg” 的软件包：</p>
<pre><code>ruxgo pkg --clean example_pkg
</code></pre>
</li>
<li>
<p>清理所有软件包：</p>
<pre><code>ruxgo pkg --clean-all
</code></pre>
</li>
</ul>
<h2 id="提示-1"><a class="header" href="#提示-1">提示</a></h2>
<ul>
<li>使用 <code>--help</code> 选项可以查看更多命令帮助。</li>
<li>确保在执行任何软件包管理操作之前，您的系统已连接到互联网。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ruxgo-help"><a class="header" href="#ruxgo-help">ruxgo help</a></h1>
<p><code>ruxgo help</code> 命令用于显示 <code>ruxgo</code> 工具的帮助信息，包括其各个子命令的详细说明。</p>
<h2 id="使用方式-2"><a class="header" href="#使用方式-2">使用方式</a></h2>
<p>要获取 <code>ruxgo</code> 工具或其任一子命令的帮助信息，您可以执行以下操作：</p>
<pre><code>ruxgo help [子命令]
</code></pre>
<h2 id="示例-2"><a class="header" href="#示例-2">示例</a></h2>
<ul>
<li>
<p>显示 <code>ruxgo</code> 的总体帮助信息：</p>
<pre><code>ruxgo help
</code></pre>
</li>
<li>
<p>查看关于 <code>init</code> 命令的详细帮助：</p>
<pre><code>ruxgo help init
</code></pre>
</li>
<li>
<p>查看关于 <code>pkg</code> 命令的详细帮助：</p>
<pre><code>ruxgo help pkg
</code></pre>
</li>
</ul>
<h2 id="提示-2"><a class="header" href="#提示-2">提示</a></h2>
<ul>
<li>不带任何子命令时，<code>ruxgo help</code> 将显示 <code>ruxgo</code> 工具的总体帮助信息，包括所有可用的命令和选项。</li>
<li>当指定一个子命令时，如 <code>ruxgo help init</code>，将显示该特定子命令的详细帮助信息。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="构建命令"><a class="header" href="#构建命令">构建命令</a></h1>
<ul>
<li>
<p><a href="commands/./ruxgo-build.html">ruxgo -b</a></p>
</li>
<li>
<p><a href="commands/./ruxgo-run.html">ruxgo -r</a></p>
</li>
<li>
<p><a href="commands/./ruxgo-clean.html">ruxgo -c</a></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ruxgo--b"><a class="header" href="#ruxgo--b">ruxgo -b</a></h1>
<p><code>ruxgo -b</code> 命令用于构建您的项目，需确保当前目录下存在 <code>config_&lt;platform&gt;.toml</code>。</p>
<h2 id="使用方式-3"><a class="header" href="#使用方式-3">使用方式</a></h2>
<p>要构建当前项目，您可以执行以下操作：</p>
<pre><code class="language-bash">ruxgo -b [--path &lt;路径&gt;] [--gen-cc] [--gen-vsc]
</code></pre>
<ul>
<li><code>--path &lt;路径&gt;</code>: 指定一个特定的目录（需存在 <code>config_&lt;platform&gt;.toml</code>）来执行构建操作。如果不提供，则默认在当前目录下执行。</li>
<li><code>--gen-cc</code>: 生成 <code>compile_commands.json</code> 文件，它包含了编译项目的所有命令。</li>
<li><code>--gen-vsc</code>: 生成 Visual Studio Code 的配置文件 <code>.vscode/c_cpp_properties.json</code>，它包含了项目的编译器配置和头文件路径。</li>
</ul>
<h2 id="命令行为-1"><a class="header" href="#命令行为-1">命令行为</a></h2>
<p>当执行 <code>ruxgo -b</code> 命令后，将会在当前目录下创建一个名为 <code>ruxgo_bld/</code> 的构建目录，包括以下内容：</p>
<pre><code class="language-bash">ruxgo_bld/
├── bin/
├── obj_linux/ 或 obj_win32/
├── target/
├── *.hash
├── compile_commands.json (如果启用了gen_cc)
├── .vscode/c_cpp_properties.json (如果启用了gen_vsc)
└── ruxmusl/ (如果使用了ruxmusl用户库)
</code></pre>
<ul>
<li><code>bin/</code>： 存放构建过程中生成的静态库、动态库、目标文件或可执行文件 。</li>
<li><code>obj_linux/obj_win32</code>： 存放编译源码生成的中间对象文件 （ *.o ）。</li>
<li><code>target</code>： 存放构建 ruxos 后生成的 target 文件。</li>
<li><code>*.hash</code>： 存放构建过程中生成的 hash 文件，用来实现增量构建。</li>
<li><code>compile_commands.json</code>： 存放构建过程中的所有编译命令，如果启用了 gen_cc。</li>
<li><code>.vscode/c_cpp_properties.json</code>： 存放项目的 vscode 配置，如果启用了 gen_vsc。</li>
<li><code>ruxmusl/</code>： 存放构建 ruxmusl 后生成的中间文件及静态库，如果使用了 ruxmusl 。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ruxgo--r"><a class="header" href="#ruxgo--r">ruxgo -r</a></h1>
<p><code>ruxgo -r</code> 命令用于运行项目中的可执行文件，需确保当前目录下存在 <code>config_&lt;platform&gt;.toml</code>。</p>
<h2 id="使用方式-4"><a class="header" href="#使用方式-4">使用方式</a></h2>
<p>要运行构建的项目，您可以执行以下操作：</p>
<pre><code>ruxgo -r [--path &lt;路径&gt;] [--bin-args &lt;参数列表&gt;]
</code></pre>
<ul>
<li><code>--path &lt;路径&gt;</code>: 指定一个特定的目录（需存在 <code>config_&lt;platform&gt;.toml</code>）来执行运行操作。如果不提供，则默认在当前目录下执行。</li>
<li><code>--bin-args=&lt;参数列表&gt;</code>: 提供一系列运行时参数传递给项目的可执行文件，参数跟在<code>=</code>后面且以逗号分隔。</li>
</ul>
<h2 id="命令行为-2"><a class="header" href="#命令行为-2">命令行为</a></h2>
<p>执行 <code>ruxgo -r</code> 命令后，将会运行 <code>bin/</code> 目录下的可执行文件。需要确保在执行目录下存在正确的配置文件，或者使用 <code>--path</code> 指定包含这些文件的目录。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ruxgo--c"><a class="header" href="#ruxgo--c">ruxgo -c</a></h1>
<p><code>ruxgo -c</code> 命令用于清理项目，需确保当前目录下存在 <code>config_&lt;platform&gt;.toml</code>。</p>
<h2 id="使用方式-5"><a class="header" href="#使用方式-5">使用方式</a></h2>
<p>要清理构建的项目，您可以执行以下操作：</p>
<pre><code>ruxgo -c [--path &lt;路径&gt;]
</code></pre>
<ul>
<li><code>--path &lt;路径&gt;</code>: 指定一个特定的目录（需存在 <code>config_&lt;platform&gt;.toml</code>）来执行清理操作。如果不提供，则默认在当前目录下执行。</li>
</ul>
<h2 id="命令行为-3"><a class="header" href="#命令行为-3">命令行为</a></h2>
<p>执行 <code>ruxgo -c</code> 命令后，<code>ruxgo</code> 提供了一个多选界面，让用户选择要清理的过程文件，按下 Esc 键则退出当前命令，按下空格（Space）键则选中要清理的项目。具体内容如下：</p>
<ul>
<li><code>All/</code>： 删除项目所有内容。</li>
<li><code>App_bins/</code>： 删除构建的 app 可执行文件及其相关库。</li>
<li><code>Obj/</code>： 删除编译源码生成的中间对象文件（*.o）。</li>
<li><code>OS/</code>： 删除 ruxos 的构建目录。</li>
<li><code>Ulib/</code>： 删除 Ulib 的构建内容，如 <code>ruxlibc</code> 或 <code>ruxmusl</code>。</li>
</ul>
<p>需要确保在执行目录下存在正确的配置文件，或者使用 <code>--path</code> 指定包含这些文件的目录。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="运行不同的app"><a class="header" href="#运行不同的app">运行不同的app</a></h1>
<p>在<code>ruxgo/apps/</code>目录下放置了所有经过测试的 Toml 文件。目前，有两种方法构建应用程序：</p>
<ul>
<li>
<p>如果在本地构建，你只需要在<code>ruxgo/apps/&lt;name&gt;/local</code>目录下下载 app 的源代码，然后使用 ruxgo 构建并运行它。</p>
</li>
<li>
<p>如果在 RuxOS 上构建，你需要将<code>config_linux.toml</code>从<code>ruxgo/apps/&lt;name&gt;/ruxos</code>复制到<code>ruxos/apps/c/&lt;name&gt;</code>，然后下载 app 的源代码并使用 ruxgo 来构建并运行它。</p>
</li>
</ul>
<p><strong>注:</strong> 有关详细信息，请参阅每个 app 目录下的 README.md。以下应用程序已获支持:</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
<a href="https://github.com/syswonder/ruxgo/tree/master/apps/redis">redis</a></li>
<li><input disabled="" type="checkbox" checked=""/>
<a href="https://github.com/syswonder/ruxgo/tree/master/apps/sqlite3">sqlite3</a></li>
<li><input disabled="" type="checkbox" checked=""/>
<a href="https://github.com/syswonder/ruxgo/tree/master/apps/iperf">iperf</a></li>
<li><input disabled="" type="checkbox" checked=""/>
helloworld</li>
<li><input disabled="" type="checkbox" checked=""/>
memtest</li>
<li><input disabled="" type="checkbox" checked=""/>
httpclient</li>
<li><input disabled="" type="checkbox" checked=""/>
httpserver</li>
<li><input disabled="" type="checkbox" checked=""/>
nginx</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="assets/fzf.umd.js"></script>
        <script src="assets/elasticlunr.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
